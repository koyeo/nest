##########################################################
#                        Nest                            #
#            用于快速部署本地本地构建部署工具                 #
#            官方文档: https://nestutil.com               #
##########################################################
version: 1.0
servers:
  161:
    host: 192.168.1.1
    user: root
envs:
  NODE_ENV: ok
tasks:
  generate:
    comment: 打包静态资源
    steps:
      - run: echo 'Im generate'
  161:
    comment: 161 集成服务
    branches: [ 'test' ]
    watch:
      - main.go
    envs:
      GOG: sgsr
    steps:
      - use: generate
      - run: echo 'Hello world'
      #- run: ./build.sh
      - deploy:
          servers:
            - use: 161
            - host: 191.168.1.199
              alias: 生产主机
              user: root
          mappers:
            - source: ./main
              target: /app/nest/bin/server_bin
          executes:
            - run: supervisorctl restart server_bin
            - run: