name: nest

workspace: .nest

env:
  - name: 测试环境
    id: env-test
    server:
      - name: 测试服务器
        id: test-node-1
        ip: 47.100.184.133
        port: 2222
        user: root
        password: Helloshic
        identity: ~/.ssh/id_rsa

script:
  - name: 测试环境部署脚本
    id: env-test-deploy
    file: build.sh
    command:
      - echo "Hello world"

task:
  - name: 生成器
    id: generator
    watch:
      - test/generator/*.go
    build:
      directory: test/generator
      command:
        - go build main.go
  - name: 主程序
    id: main
    watch:
      - test/test.go
      - test/second/**/*.go
    run: go run main.go
    build:
      directory: test
      command:
        - go build test.go
        - echo "Hello world"
    deploy:
      - env: env-test
        log:
          dir: /path/to/log
        pid: /path/to/pid
        script:
          - env-test-deploy
        command:
          - git pull



